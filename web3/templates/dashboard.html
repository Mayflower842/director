{% extends "base.html" %}
{% load staticfiles %}

{% block css %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'css/dashboard.css' %}" />
{% endblock %}

{% block js %}
    {{ block.super }}
    <script type="text/javascript" src="{% static 'js/sites/search.js' %}"></script>
{% endblock %}

{% block navbar %}
<input class="form-control search-box" id="select-site" type="text" placeholder="&#xf002; Search Sites" />
{% if site_requests %}
<a class="nav-warn" href="{% url 'approve_site' %}"><b>{{ site_requests.count }}</b> Request{{ site_requests.count|pluralize }}</a>
{% endif %}
{% endblock %}
{% block main %}
<div class="subheading clearfix">
    <h3 class="pull-left">Your Sites <span id="filtered"></span></h3>
    <a href="{% url 'create_site' %}" class="pull-right btn btn-ion"><i class="fa fa-plus"></i> Create Site</a>
    {% if request.user.is_staff or request.user.is_superuser %}
    <a href="{% url 'create_webdocs' %}" class="pull-right btn btn-ion" style="margin-right:5px"><i class="fa fa-user-plus"></i> Create Webdocs</a>
    {% endif %}
</div>
<div id="sites">
{% for site in sites %}
    <a href="{% url 'info_site' site.id %}" class="site" id="{{ site.id }}">
        {% if site.database %}<span class="pull-right tag tag-primary">{{ site.database.get_category_display }}</span>{% endif %}
        {% if site.has_repo %}<span data-toggle="tooltip"  data-placement="left" title="This site uses Git for version control." class="pull-right tag tag-default"><i class="fa fa-github-alt"></i> Git</span>{% endif %}
        {% if site.has_vm %}<span data-toggle="tooltip"  data-placement="left" title="This site has a virtual machine for its website." class="pull-right tag tag-info"><i class="fa fa-server"></i> VM</span>{% endif %}
        {% if site.custom_nginx %}<span data-toggle="tooltip" data-placement="left" title="This site has a custom nginx configuration." class="pull-right tag tag-info">Nginx</span>{% endif %}
        <i class="pull-left fa fa-2x fa-fw {% if site.purpose == 'user' %}fa-user{% elif site.purpose == 'activity' %}fa-globe{% else %}fa-cube{% endif %}"></i>
        <b class="name">{{ site.name }}</b><span class="sub"><span class="type">{{ site.get_category_display }}</span> - <span class="desc">{{ site.description|default:"No Description" }}</span> - <span class="users">{{ site.num_users|add:"-1" }} user{% if site.num_users != 2 %}s{% endif %}</span></span>
    </a>
{% endfor %}
{% if other_sites %}
    {% for site in other_sites %}
    <a href="{% url 'info_site' site.id %}" class="site" id="{{ site.id }}">
        <span data-toggle="tooltip"  data-placement="left" title="You can see this website because you are a superuser." class="pull-right tag tag-warning">Superuser</span>
        {% if site.has_repo %}<span data-toggle="tooltip"  data-placement="left" title="This site uses Git for version control." class="pull-right tag tag-default"><i class="fa fa-github-alt"></i> Git</span>{% endif %}
        {% if site.custom_nginx %}<span data-toggle="tooltip" data-placement="left" title="This site has a custom nginx configuration." class="pull-right tag tag-info">Nginx</span>{% endif %}
        {% if site.num_users <= 1 %}<span data-toggle="tooltip" data-placement="left" title="There are no users, other than superusers, that can access this site." class="pull-right tag tag-danger">No Users</span>{% endif %}
        {% if site.database %}<span class="pull-right tag tag-primary">{{ site.database.get_category_display }}</span>{% endif %}
        <i class="pull-left fa fa-2x fa-fw {% if site.purpose == 'user' %}fa-user{% else %}fa-globe{% endif %}"></i>
        <b class="name">{{ site.name }}</b><span class="sub"><span class="type">{{ site.get_category_display }}</span> - <span class="desc">{{ site.description|default:"No Description" }}</span> - <span class="users">{{ site.num_users|add:"-1" }} user{% if site.num_users != 2 %}s{% endif %}</span></span>
    </a>
    {% endfor %}
{% endif %}
{% if sites.count == 0 and other_sites.count == 0 %}
<div id="empty">You don't have any sites! Click <a href="{% url 'create_site' %}">here</a> to create a new site.</div>
{% endif %}
</div>
{% endblock %}
